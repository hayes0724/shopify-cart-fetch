!function(t,e){for(var n in e)t[n]=e[n];e.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})}(exports,(()=>{"use strict";var t={488:(t,e,n)=>{n.r(e),n.d(e,{addItem:()=>i,addItemFromForm:()=>u,clearAttributes:()=>p,clearItems:()=>c,clearNote:()=>b,default:()=>g,getAttributes:()=>y,getNote:()=>f,getState:()=>r,removeItem:()=>d,updateAttributes:()=>m,updateItem:()=>o,updateItemById:()=>h,updateNote:()=>l});class a{constructor(t=new DocumentFragment){this.bus=t}static publish(t,e,n){return new CustomEvent(`${t}:${e}`,{detail:n})}on(t,e){this.bus.addEventListener(t,e)}emit(t,e,n){this.bus.dispatchEvent(a.publish(t,e,n))}}async function s(t,e){const n={...JSON.parse(JSON.stringify({method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json;"}}))};return e&&(n.body=JSON.stringify(e)),await fetch(t,{...n}).then((t=>t.json())).then((t=>t))}async function r(){return await fetch("/cart.js").then((t=>t.json())).then((t=>t))}async function i(t){return await s("/cart/add.js",t)}async function u(t){const e=new FormData(t);if(!e.get("id"))throw"Cart form missing required property ID";return await s("/cart/add.js",e)}async function c(){return await s("/cart/clear.js")}async function o(t){return await s("/cart/change.js",t)}async function h(t){return await s("/cart/change.js",t)}async function d(t){return await s("/cart/change.js",{quantity:0,...t})}async function y(){return r().then((t=>t.attributes))}async function m(t){return await s("/cart/update.js",{attributes:{...t}})}async function p(){return r().then((t=>t.attributes)).then((t=>{const e={};return Object.getOwnPropertyNames(t).forEach((t=>e[t]="")),e})).then((t=>s("/cart/update.js",{attributes:t})))}async function f(){return r().then((t=>t.note))}async function l(t){return await s("/cart/update.js",{note:t})}async function b(){return await s("/cart/update.js",{note:""})}class g{constructor(){this.events=new a,this.findItem=t=>this.state.items.find((e=>e.key===t)),this.findItemIndex=t=>this.state.items.findIndex((e=>e.key===t)),this.getState=async()=>this.run("cart-fetch",r),this.addItem=async t=>this.runLine("cart-add",i,t),this.addItemFromForm=async t=>this.runLine("cart-add",u,t),this.clearItems=async()=>this.run("cart-update",c),this.removeItem=async t=>this.runLine("cart-remove",d,t),this.updateItem=async t=>this.runLine("cart-update",o,t),this.updateItemById=async t=>this.runLine("cart-update",h,t),this.updateAttributes=async t=>this.run("cart-update",m,t),this.clearAttributes=async()=>this.run("cart-update",p),this.getAttributes=y,this.getNote=f,this.updateNote=async t=>this.run("cart-update",l,t),this.clearNote=async()=>this.run("cart-update",b)}get state(){return this._state}set state(t){this._state=t}async run(t,e,n){return this.events.emit(t,"start"),this.state=await e(n),this.events.emit(t,"complete",this.state),this.state}async runLine(t,e,n){this.events.emit(t,"start");const a=await e(n),s=this.findItemIndex(a.key);return s>-1&&a.quantity>0?this.state.items[s]=a:this.state.items.push(a),this.events.emit(t,"complete",this.state),a}}}},e={};function n(a){if(e[a])return e[a].exports;var s=e[a]={exports:{}};return t[a](s,s.exports,n),s.exports}return n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(488)})());
//# sourceMappingURL=index.common.min.js.map